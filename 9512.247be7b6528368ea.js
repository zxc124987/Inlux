"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[9512],{1919:function(e,t,s){s.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-responsive"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.data,"row-key":e.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":e.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":e.selectChangeHandler}},[e._t("custom-selection"),e._t("custom-checkbox1"),e._t("custom-checkbox2"),e._l(e.tableColumns,(function(s,a){return t("el-table-column",{key:a,attrs:{prop:s.id,label:s.label,width:s.width,sortable:"date"===s.id},scopedSlots:e._u([{key:"default",fn:function(a){return["status"===s.id?t("el-tag",{attrs:{type:"簽核通過"===a.row.status||"審核通過"===a.row.status?"success":"拒絕申請"===a.row.status?"danger":"草稿"===a.row.status?"warning":"查無資料"}},[e._v(" "+e._s(a.row.status)+" ")]):"status_Id"===s.id?t("el-tag",{attrs:{type:"OPEN"===a.row.status_Id?"":"CLOSE"===a.row.status_Id?"danger":"FULL"===a.row.status_Id?"warning":"success"}},[e._v(" "+e._s(e.getCourseState(a.row.status_Id))+" ")]):"description2"===s.id?t("el-tag",{attrs:{type:"有效課程"===a.row.description?"":"danger"}},[e._v(" "+e._s(a.row.description)+" ")]):"approve_Status"===s.id?t("el-tag",{attrs:{type:"0"===a.row.approve_Status?"":"1"===a.row.approve_Status?"success":"danger"}},[e._v(" "+e._s(e.getApproveStatus(a.row.approve_Status))+" ")]):"approve_Status2"===s.id?t("el-tag",{attrs:{type:"審核中"===a.row.approve_Status2||"未審核"===a.row.approve_Status2?"":"審核完畢"===a.row.approve_Status2||"審核同意"===a.row.approve_Status2?"success":"danger"}},[e._v(" "+e._s(a.row.approve_Status2)+" ")]):"attend_Status"===s.id?t("el-tag",{attrs:{type:"0"===a.row.attend_Status?"":"1"===a.row.attend_Status?"success":"danger"}},[e._v(" "+e._s(e.getAttendStatus(a.row.attend_Status))+" ")]):"issue_Card"===s.id?t("el-tag",{attrs:{type:"0"===a.row.issue_Card?"":"1"===a.row.issue_Card?"success":"danger"}},[e._v(" "+e._s(e.getIssueCardStatus(a.row.issue_Card))+" ")]):"signUpStatus"===s.id?t("el-tag",{attrs:{type:"已結案"===e.signUpStatus(a.row.signUpStatus,a.row.approveStatus)?"success":"可取消報名"===e.signUpStatus(a.row.signUpStatus,a.row.approveStatus)?"danger":""}},[e._v(" "+e._s(e.signUpStatus(a.row.signUpStatus,a.row.approveStatus))+" ")]):"file_Name"===s.id||"d_File_Name"===s.id?t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(a.row)}}},[e._v(e._s(a.row[s.id]))]):"protocolInfo"===s.id?t("div",[t("div",[e._v(e._s(a.row.po_Name))]),e._l(a.row.files,(function(s){return t("div",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(s)}}},[e._v(e._s(s.file_Name))])])}))],2):"useable"===s.id&&"已刪除(廠商不可申請每日工單)"===a.row.useable?t("span",{staticStyle:{color:"red"}},[e._v(e._s(a.row.useable))]):"deleted"===s.id?t("span",{class:{"text-danger":"1"===a.row.deleted}},[e._v(" "+e._s(a.row.effect)+" ")]):"array_data"===s.id?t("span",e._l(a.row[s.id],(function(s,a){return t("p",{key:a,staticClass:"mb-0"},[e._v(e._s(s))])})),0):RegExp(/\n/).test(a.row[a.column.property])?t("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(a.row[s.id])+" ")]):t("span",[e._v(e._s(a.row[s.id]))])]}}],null,!0)})})),e._t("custom-edit-select"),e._t("custom-switch"),e._t("custom-function"),e._t("slot-sheet-open")],2)],1)},r=[],o={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(e){this.$emit("selectionChange",e)},downloadPdf(e){const t=e.file_Id;this.$emit("downloadPdfHandler",t),this.$emit("downloadPdfHandler2",e)},getRowKeys(e){return e.index?e.index:e.id},rowStyleHandler(e){if("1"===e.row.isWeekend||"1"===e.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},l=o,i=s(1001),n=(0,i.Z)(l,a,r,!1,null,"4a0f1604",null),c=n.exports},9512:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[e._m(0),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"異動申請"}},[t("div",[e._v(" 步驟："),t("br"),e._v("1.點選【承攬商入廠施工群組】→ 2.點選【人員】→ 3.點選【送出】"),t("br"),t("br"),t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form}},[t("el-form-item",{attrs:{label:"1.承攬商入廠施工群組",prop:"course_Id"}},[t("el-select",{attrs:{clearable:"",placeholder:"請選擇","value-key":"index"},on:{change:e.courseIdChangeHandler},model:{value:e.form.course_Id,callback:function(t){e.$set(e.form,"course_Id",t)},expression:"form.course_Id"}},e._l(e.course1Data,(function(e,s){return t("el-option",{key:s,attrs:{label:e.label,value:e}})})),1)],1),t("el-form-item",{attrs:{label:"2.選擇人員",prop:"applyPeople"}},[t("span",{staticClass:"directions"},[e._v("若無任何名單顯示，表示貴公司目前尚未建立任何員工資料")]),t("div",{staticClass:"d-flex align-items-center mt-2"},[t("el-select",{attrs:{placeholder:"請選擇",multiple:"","value-key":"id",disabled:!e.form.course_Id},on:{change:e.peopleChangeHandler},model:{value:e.form.applyPeople,callback:function(t){e.$set(e.form,"applyPeople",t)},expression:"form.applyPeople"}},e._l(e.coursePeople,(function(e,s){return t("el-option",{key:s,attrs:{label:e.label,value:e}})})),1)],1)]),t("el-form-item",{staticClass:"mb-1",attrs:{label:"3.資料送出"}}),t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("th",{staticClass:"text-nowrap"},[e._v("項次")]),t("th",{staticClass:"text-nowrap"},[e._v("身分證字號(姓名)")])])]),t("tbody",e._l(e.form.people,(function(s,a){return t("tr",{key:a},[t("td",[e._v(e._s(a+1))]),t("td",[e._v(" "+e._s(s.id)+"("+e._s(s.P_Name)+") ")])])})),0)])]),t("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.resetForm("form")}}},[e._v("重設")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("送出")])],1)],1)]),t("el-tab-pane",{attrs:{label:"人員清單"}},[t("h2",{staticClass:"form-title mb-0",staticStyle:{padding:"10px 0"}},[e._v("人員清單")]),t("div",{staticStyle:{padding:"10px 0"}},[e._v("只顯示30天內的已結案名單")]),e.selectedItem.length?t("div",{staticClass:"d-flex align-items-center my-2 selected-box"},[t("span",[e._v("已選 "+e._s(e.selectedItem.length)+" 項")]),t("el-popconfirm",{attrs:{title:"請問您確定要取消此次遺失異動申請嗎？"},on:{confirm:function(t){return e.updCancelIdSignUp()}}},[t("el-button",{staticClass:"ms-2",attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[e._v("取消申請")])],1)],1):e._e(),t("tableComponent",{ref:"cancelMultipleTable",attrs:{data:e.cancelIdSignUpList,tableColumns:e.cancelTableColumns},on:{selectionChange:e.selectionChangeHandler},scopedSlots:e._u([{key:"custom-selection",fn:function(){return[t("el-table-column",{attrs:{type:"selection",width:"100","reserve-selection":!0,selectable:e.canSelectRow}})]},proxy:!0}])}),t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.CancelSignUp4CardData.length,"current-page":e.cancelSignUpPage},on:{"current-change":e.cancelSignUpChange}})],1)],1)],1)},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"container mw-100 px-0"},[t("div",{staticClass:"d-flex align-items-center mb-4"},[t("div",{staticClass:"col"},[t("h2",{staticClass:"form-title mb-0"},[e._v("識別証異動申請")])])])])}],o=s(1919),l=s(942),i={name:"idCardApply-component",components:{tableComponent:o.Z},data(){return{dialogVisible:!1,config:l,fileIndex:0,selectedItem:[],courseNo:"",courseId:"",form:{course_Id:"",applyPeople:[]},rules:{course_Id:[{required:!0,message:"必填",trigger:"change"}],applyPeople:[{required:!0,message:"必填",trigger:"change"}]},cancelTableColumns:[{id:"index",label:"項次",width:"70"},{id:"col1",label:"姓名 (性別) 身分證字號",width:"180"},{id:"col3",label:"申請日期 (申請原因)",width:"200"},{id:"col4",label:"承攬商入廠施工群組 ",width:"300"},{id:"col5",label:"審查狀態(總務) ",width:"150"}],course1Data:[],course2Data:[],coursePeople:[],course1List:[],CancelSignUp4CardData:[],cancelIdSignUpList:[],cancelSignUpPage:1,courseListPage:1}},computed:{},methods:{async getData(){const e=await this.$store.dispatch("qryVenCourseList"),t=e.data.data;this.course1Data=JSON.parse(JSON.stringify(t.course1)),this.course1Data=this.course1ListColumns(this.course1Data),this.course1List=this.course1Data.slice(0,10);const s=await this.$store.dispatch("cancelIdSignUpList"),a=s.data.data;this.CancelSignUp4CardData=JSON.parse(JSON.stringify(a)),this.CancelSignUp4CardData=this.cancelSignUpListColumns(this.CancelSignUp4CardData),this.cancelIdSignUpList=this.CancelSignUp4CardData.slice(0,10)},cancelSignUpChange(e){this.cancelSignUpPage=e;const t=10*(e-1),s=10*e;this.cancelIdSignUpList=this.CancelSignUp4CardData.slice(t,s)},courseListChange(e){this.courseListPage=e;const t=10*(e-1),s=10*e;this.course1List=this.course1Data.slice(t,s)},beginDateHandler(e,t){console.log("people."+t),e?this.$refs.form.clearValidate("people."+t):this.$refs.form.validateField("people."+t)},fileChangeHandler(e){this.form.people.forEach((async(t,s)=>{s===this.fileIndex&&(t.fileName=e.name,t.fileBase64=await this.toBase64(e.raw),t.uid=e.uid)})),this.$refs.form.clearValidate("people."+this.fileIndex+".fileName")},courseIdChangeHandler(e){const t=e.course_Id;this.courseId=e.course_Id,this.$store.dispatch("qryIdChangePeople",t).then((e=>{const t=e.data.data;this.coursePeople=t,this.coursePeople.forEach((e=>e.label=`${e.P_Name}(${e.id})`))})),this.form.people=[],this.form.applyPeople=[]},closeDialog(){this.form.schedule_No="",this.dialogVisible=!1,this.psdInput=""},peopleChangeHandler(e){this.form.people=e},selectionChangeHandler(e){this.selectedItem=e},canSelectRow(e){return"審查中"==e.approve_Status},updCancelIdSignUp(){this.$store.dispatch("updCancelIdSignUp",this.selectedItem).then((e=>{e.data.isOK&&(this.$message({type:"success",duration:5e3,showClose:!0,message:"修改成功"}),this.cancelSignUpPage=1,this.getData(),this.$refs.cancelMultipleTable.$refs.multipleTable.clearSelection())}))},submitForm(e){this.$refs[e].validate((async t=>{t?(this.form.course_Id=this.courseId,this.$store.dispatch("saveApplyPeople",this.form).then((t=>{t.data.isOK&&(this.$message({type:"success",duration:"5000",showClose:!0,message:"送出成功"}),this.resetForm(e),this.getData())}))):this.$message({type:"error",duration:"5000",showClose:!0,message:"資料填寫錯誤"})}))},resetForm(e){this.$refs[e].resetFields(),this.form.people=[]},course1ListColumns(e){return e.forEach(((e,t)=>{e.index=t+1,e.label=`${e.course_Name}`})),e},cancelSignUpListColumns(e){return e.forEach(((e,t)=>{e.index=t+1,e.col1=`${e.p_Name}/${e.sex}/${e.id}`,e.col3=`${e.apply_Date} (遺失)`,e.col4=`${e.course_Name}`,e.col5=`${e.approve_Status}`,e.statusClass="拒絕"===e.approve_Status?"rejected":""})),e}},mounted(){this.getData(),this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0}},n=i,c=s(1001),d=(0,c.Z)(n,a,r,!1,null,"3d66b398",null),p=d.exports}}]);
//# sourceMappingURL=9512.247be7b6528368ea.js.map