"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[6461],{1919:function(e,t,s){s.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-responsive"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.data,"row-key":e.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":e.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":e.selectChangeHandler}},[e._t("custom-selection"),e._t("custom-checkbox1"),e._t("custom-checkbox2"),e._l(e.tableColumns,(function(s,a){return t("el-table-column",{key:a,attrs:{prop:s.id,label:s.label,width:s.width,sortable:"date"===s.id},scopedSlots:e._u([{key:"default",fn:function(a){return["status"===s.id?t("el-tag",{attrs:{type:"簽核通過"===a.row.status||"審核通過"===a.row.status?"success":"拒絕申請"===a.row.status?"danger":"草稿"===a.row.status?"warning":"查無資料"}},[e._v(" "+e._s(a.row.status)+" ")]):"status_Id"===s.id?t("el-tag",{attrs:{type:"OPEN"===a.row.status_Id?"":"CLOSE"===a.row.status_Id?"danger":"FULL"===a.row.status_Id?"warning":"success"}},[e._v(" "+e._s(e.getCourseState(a.row.status_Id))+" ")]):"description2"===s.id?t("el-tag",{attrs:{type:"有效課程"===a.row.description?"":"danger"}},[e._v(" "+e._s(a.row.description)+" ")]):"approve_Status"===s.id?t("el-tag",{attrs:{type:"0"===a.row.approve_Status?"":"1"===a.row.approve_Status?"success":"danger"}},[e._v(" "+e._s(e.getApproveStatus(a.row.approve_Status))+" ")]):"approve_Status2"===s.id?t("el-tag",{attrs:{type:"審核中"===a.row.approve_Status2||"未審核"===a.row.approve_Status2?"":"審核完畢"===a.row.approve_Status2||"審核同意"===a.row.approve_Status2?"success":"danger"}},[e._v(" "+e._s(a.row.approve_Status2)+" ")]):"attend_Status"===s.id?t("el-tag",{attrs:{type:"0"===a.row.attend_Status?"":"1"===a.row.attend_Status?"success":"danger"}},[e._v(" "+e._s(e.getAttendStatus(a.row.attend_Status))+" ")]):"issue_Card"===s.id?t("el-tag",{attrs:{type:"0"===a.row.issue_Card?"":"1"===a.row.issue_Card?"success":"danger"}},[e._v(" "+e._s(e.getIssueCardStatus(a.row.issue_Card))+" ")]):"signUpStatus"===s.id?t("el-tag",{attrs:{type:"已結案"===e.signUpStatus(a.row.signUpStatus,a.row.approveStatus)?"success":"可取消報名"===e.signUpStatus(a.row.signUpStatus,a.row.approveStatus)?"danger":""}},[e._v(" "+e._s(e.signUpStatus(a.row.signUpStatus,a.row.approveStatus))+" ")]):"file_Name"===s.id||"d_File_Name"===s.id?t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(a.row)}}},[e._v(e._s(a.row[s.id]))]):"protocolInfo"===s.id?t("div",[t("div",[e._v(e._s(a.row.po_Name))]),e._l(a.row.files,(function(s){return t("div",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(s)}}},[e._v(e._s(s.file_Name))])])}))],2):"useable"===s.id&&"已刪除(廠商不可申請每日工單)"===a.row.useable?t("span",{staticStyle:{color:"red"}},[e._v(e._s(a.row.useable))]):"deleted"===s.id?t("span",{class:{"text-danger":"1"===a.row.deleted}},[e._v(" "+e._s(a.row.effect)+" ")]):"array_data"===s.id?t("span",e._l(a.row[s.id],(function(s,a){return t("p",{key:a,staticClass:"mb-0"},[e._v(e._s(s))])})),0):RegExp(/\n/).test(a.row[a.column.property])?t("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(a.row[s.id])+" ")]):t("span",[e._v(e._s(a.row[s.id]))])]}}],null,!0)})})),e._t("custom-edit-select"),e._t("custom-switch"),e._t("custom-function"),e._t("slot-sheet-open")],2)],1)},l=[],i={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(e){this.$emit("selectionChange",e)},downloadPdf(e){const t=e.file_Id;this.$emit("downloadPdfHandler",t),this.$emit("downloadPdfHandler2",e)},getRowKeys(e){return e.index?e.index:e.id},rowStyleHandler(e){if("1"===e.row.isWeekend||"1"===e.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},o=i,r=s(1001),n=(0,r.Z)(o,a,l,!1,null,"4a0f1604",null),c=n.exports},7163:function(e,t,s){s.d(t,{Z:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload"},[t("el-upload",{ref:"Upload",staticClass:"upload-demo",attrs:{limit:e.limitNumber,action:e.uploadAction,"auto-upload":!1,"on-change":e.changeHandler,"on-remove":e.removeHandler}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上傳檔案")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTipText))])],1)],1)},l=[],i=s(942),o={name:"upload-component",data(){return{}},props:{uploadTipText:{type:[String],default:"檔案格式為PDF，在2MB以內"},uploadAction:{type:[String],default:i.apiUrl},limitNumber:{type:Number,default:1}},methods:{changeHandler(e,t){this.$emit("fileChangeHandler",t)},removeHandler(e,t){this.$emit("fileRemoveHandler",t)}},mounted(){}},r=o,n=s(1001),c=(0,n.Z)(r,a,l,!1,null,"442b61f1",null),d=c.exports},6461:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[e._m(0),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"申請報名"}},[t("ul",{staticClass:"text-secondary ps-0"},[e._v(" 注意事項： "),t("li",{staticClass:"text-secondary"},[e._v("本公司不接受現場報名，請務必於本網站進行報名。")]),t("li",{staticClass:"text-secondary"},[e._v("課程有分南科場次(南廠證件)、竹科場次(北廠證件)及跨廠區換證。")]),t("li",{staticClass:"text-secondary"},[e._v("課程選單只會秀出可報名之課程，且人數有上限限制。")]),t("li",{staticClass:"text-secondary"},[e._v("不論報名人數是否額滿，開課狀態如為結課CLOSE狀態，即無法再報名。")]),t("li",{staticClass:"text-secondary"},[e._v("如果個人報名的課程因故異動為不開課，請自行取消報名。")]),t("li",{staticClass:"text-secondary"},[e._v("上課當天無法取消報名，如因故無法到場，請提前取消，避免佔席。")])]),t("div",[e._v(" 報名步驟："),t("br"),e._v("1.點選【選擇課程】→ 2.點選【報名人員】→ 3.點選【資料上傳】"),t("br"),t("br"),t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form}},[t("el-form-item",{attrs:{label:"1.選擇課程",prop:"schedule_No"}},[t("el-select",{attrs:{clearable:"",placeholder:"請選擇","value-key":"index"},on:{change:e.courseChangeHandler},model:{value:e.form.schedule_No,callback:function(t){e.$set(e.form,"schedule_No",t)},expression:"form.schedule_No"}},e._l(e.course1Data,(function(e,s){return t("el-option",{key:s,attrs:{label:e.label,value:e}})})),1)],1),t("el-form-item",{attrs:{label:"2.選擇報名人員",prop:"applyPeople"}},[t("span",{staticClass:"directions"},[e._v("若無任何名單顯示，表示貴公司目前尚未建立任何員工資料")]),t("div",{staticClass:"d-flex align-items-center mt-2"},[t("el-select",{attrs:{placeholder:"請選擇",multiple:"","value-key":"id",disabled:!e.form.schedule_No},on:{change:e.peopleChangeHandler},model:{value:e.form.applyPeople,callback:function(t){e.$set(e.form,"applyPeople",t)},expression:"form.applyPeople"}},e._l(e.coursePeople,(function(e,s){return t("el-option",{key:s,attrs:{label:e.label,value:e}})})),1)],1)]),t("el-form-item",{staticClass:"mb-1",attrs:{label:"3.資料上傳"}},[t("span",{staticClass:"directions"},[e._v("保險時間必填，請依保單內容為主。報名準備資料可參考問答集")])]),t("div",{staticClass:"table-responsive"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("th",{staticClass:"text-nowrap"},[e._v("項次")]),t("th",{staticClass:"text-nowrap"},[e._v("身分證字號(姓名)")]),t("th",{staticClass:"text-nowrap"},[e._v("保險展延時間(開始)")]),t("th",{staticClass:"text-nowrap"},[e._v("保險展延時間(結束)")]),t("th",{staticClass:"text-nowrap"},[e._v("報名資料上傳")])])]),t("tbody",e._l(e.form.people,(function(s,a){return t("tr",{key:a},[t("td",[e._v(e._s(a+1))]),t("td",[e._v(" "+e._s(s.id)+"("+e._s(s.p_Name)+") ")]),t("td",[t("el-form-item",{staticClass:"mb-0",attrs:{prop:"people."+a+".insurance_Begin_Date",rules:{required:!0,message:"必填",trigger:"blur"}}},[t("el-date-picker",{attrs:{placeholder:"請選擇日期",type:"date","value-format":"yyyy/MM/dd",format:"yyyy/MM/dd",clearable:""},model:{value:s.insurance_Begin_Date,callback:function(t){e.$set(s,"insurance_Begin_Date",t)},expression:"item.insurance_Begin_Date"}})],1)],1),t("td",[t("el-form-item",{staticClass:"mb-0",attrs:{prop:"people."+a+".insurance_End_Date",rules:{required:!0,message:"必填",trigger:"blur"}}},[t("el-date-picker",{attrs:{placeholder:"請選擇日期",type:"date","value-format":"yyyy/MM/dd",format:"yyyy/MM/dd",clearable:""},model:{value:s.insurance_End_Date,callback:function(t){e.$set(s,"insurance_End_Date",t)},expression:"item.insurance_End_Date"}})],1)],1),t("td",[t("el-form-item",{staticClass:"mb-0",attrs:{prop:"people."+a+".fileName",rules:{required:!0,message:"必填",trigger:"blur"}}},[t("el-upload",{ref:"upload",refInFor:!0,staticClass:"upload-demo",attrs:{"auto-upload":!1,action:e.config.apiUrl,"on-change":e.fileChangeHandler,"on-remove":e.fileRemoveHandler},model:{value:s.fileName,callback:function(t){e.$set(s,"fileName",t)},expression:"item.fileName"}},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.fileIndex=a}}},[e._v("上傳檔案")])],1)],1)],1)])})),0)])]),t("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.resetForm("form")}}},[e._v("重設")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("送出")])],1)],1)]),t("el-tab-pane",{attrs:{label:"報名清單"}},[t("h2",{staticClass:"form-title mb-0",staticStyle:{padding:"10px 0"}},[e._v("報名人員清單")]),t("div",{staticStyle:{padding:"10px 0"}},[e._v("只顯示30天內的已結案名單")]),e.selectedItem.length?t("div",{staticClass:"d-flex align-items-center my-2 selected-box"},[t("span",[e._v("已選 "+e._s(e.selectedItem.length)+" 項")]),t("el-popconfirm",{attrs:{title:"請問您確定要取消此次課程報名嗎？"},on:{confirm:function(t){return e.updCancelSignUp()}}},[t("el-button",{staticClass:"ms-2",attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[e._v("取消報名")])],1)],1):e._e(),t("tableComponent",{ref:"cancelMultipleTable",attrs:{data:e.cancelSignUpList,tableColumns:e.cancelTableColumns},on:{selectionChange:e.selectionChangeHandler},scopedSlots:e._u([{key:"custom-selection",fn:function(){return[t("el-table-column",{attrs:{type:"selection",width:"100","reserve-selection":!0,selectable:e.canSelectRow}})]},proxy:!0}])}),t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.cancelSignUpData.length,"current-page":e.cancelSignUpPage},on:{"current-change":e.cancelSignUpChange}}),t("h2",{staticClass:"form-title mb-0",staticStyle:{padding:"10px 0"}},[e._v("近期課程清單 (3個月內)")]),t("tableComponent",{ref:"multipleTable",attrs:{data:e.course2List,tableColumns:e.courseTableColumns}}),t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.course2Data.length,"current-page":e.courseListPage},on:{"current-change":e.courseListChange}})],1)],1),t("el-dialog",{attrs:{title:"請輸入專班密碼",visible:e.dialogVisible,width:"40%","before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",[t("el-form-item",{attrs:{label:"請輸入專班密碼"}},[t("el-input",{ref:"psdInput",model:{value:e.psdInput,callback:function(t){e.psdInput=t},expression:"psdInput"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closeDialog()}}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitPsdDialog()}}},[e._v("確定")])],1)],1)],1)},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"container mw-100 px-0"},[t("div",{staticClass:"d-flex align-items-center mb-4"},[t("div",{staticClass:"col"},[t("h2",{staticClass:"form-title mb-0"},[e._v("課程報名")])])])])}],i=s(1919),o=s(7163),r=s(942),n={name:"applyCourse-component",components:{tableComponent:i.Z,UploadComponent:o.Z},data(){return{dialogVisible:!1,config:r,fileIndex:0,selectedItem:[],psd:"",psdInput:"",scheduleNo:"",form:{available_Begin_Date:"",schedule_No:"",applyPeople:[],class_Date:""},rules:{schedule_No:[{required:!0,message:"必填",trigger:"change"}],applyPeople:[{required:!0,message:"必填",trigger:"change"}]},cancelTableColumns:[{id:"index",label:"項次",width:"70"},{id:"col1",label:"姓名 (性別) 身分證字號",width:"180"},{id:"signUpStatus",label:"報名狀態",width:"125"},{id:"reject_reason",label:"退件原因",width:"100"},{id:"fileName",label:"入廠危害告知附檔",width:"150"},{id:"col3",label:"保險展延期間 (起~迄)",width:"200"},{id:"col4",label:"上課日期/課程狀態",width:"150"},{id:"col5",label:"報名日期/課程名稱",width:"225"},{id:"room_Desc",label:"課程地點",width:"150"},{id:"p_She_Class_Date",label:"最近上課日期",width:"150"}],courseTableColumns:[{id:"index",label:"項次",width:"70"},{id:"col2",label:"上課日期",width:"200"},{id:"room_Description",label:"教室地點",width:"200"},{id:"col4",label:"上課時間",width:"150"},{id:"col5",label:"課程名稱(課表編號)",width:"350"},{id:"col6",label:"已報名人數/人數上限",width:"175"},{id:"status_Id",label:"開課狀態",width:"100"}],course1Data:[],course2Data:[],coursePeople:[],course2List:[],cancelSignUpData:[],cancelSignUpList:[],cancelSignUpPage:1,courseListPage:1}},computed:{},methods:{async getData(){const e=await this.$store.dispatch("qryCourseList"),t=e.data.data;this.course1Data=JSON.parse(JSON.stringify(t.course1)),this.course2Data=JSON.parse(JSON.stringify(t.course2)),this.course1Data=this.course1ListColumns(this.course1Data),this.course2Data=this.course2ListColumns(this.course2Data),this.course2List=this.course2Data.slice(0,10);const s=await this.$store.dispatch("cancelSignUpList"),a=s.data.data;this.cancelSignUpData=JSON.parse(JSON.stringify(a)),this.cancelSignUpData=this.cancelSignUpListColumns(this.cancelSignUpData),this.cancelSignUpList=this.cancelSignUpData.slice(0,10)},cancelSignUpChange(e){this.cancelSignUpPage=e;const t=10*(e-1),s=10*e;this.cancelSignUpList=this.cancelSignUpData.slice(t,s)},courseListChange(e){this.courseListPage=e;const t=10*(e-1),s=10*e;this.course2List=this.course2Data.slice(t,s)},beginDateHandler(e,t){console.log("people."+t),e?this.$refs.form.clearValidate("people."+t):this.$refs.form.validateField("people."+t)},fileChangeHandler(e){this.form.people.forEach((async(t,s)=>{s===this.fileIndex&&(t.fileName=e.name,t.fileBase64=await this.toBase64(e.raw),t.uid=e.uid)})),this.$refs.form.clearValidate("people."+this.fileIndex+".fileName")},fileRemoveHandler(e){this.form.people.forEach((t=>{t.uid===e.uid&&(t.fileName="",t.fileBase64="",t.uid="")})),this.$refs.form.validateField("people."+this.fileIndex+".fileName")},courseChangeHandler(e){const t=e.course_Id;this.scheduleNo=e.schedule_No,this.form.class_Date=e.class_Date,this.form.available_Begin_Date=e.available_Begin_Date,this.$store.dispatch("qryCoursePeople",t).then((e=>{const t=e.data.data;this.coursePeople=t,this.coursePeople.forEach((e=>e.label=`${e.p_Name}(${e.id})`))})),this.form.people=[],this.form.applyPeople=[],"Y"===e.special_Class&&(this.dialogVisible=!0,this.psd=e.password)},closeDialog(){this.form.schedule_No="",this.dialogVisible=!1,this.psdInput=""},submitPsdDialog(){this.psd===this.psdInput?(this.dialogVisible=!1,this.$message({type:"success",duration:"5000",showClose:!0,message:"密碼正確"})):(this.$message({type:"error",duration:"5000",showClose:!0,message:"密碼輸入錯誤"}),this.$refs.psdInput.focus()),this.psdInput=""},peopleChangeHandler(e){this.form.people=e},selectionChangeHandler(e){this.selectedItem=e},canSelectRow(e){return!(e.available_Begin_Date<=this.formatDate(new Date)||"2"===e.approve_Status)},updCancelSignUp(){this.$store.dispatch("updCancelSignUp",this.selectedItem).then((e=>{e.data.isOK&&(this.$message({type:"success",duration:5e3,showClose:!0,message:"修改成功"}),this.cancelSignUpPage=1,this.getData(),this.$refs.cancelMultipleTable.$refs.multipleTable.clearSelection())}))},submitForm(e){this.$refs[e].validate((async t=>{if(t){this.form.schedule_No=this.scheduleNo;let t=null,s=null;t=this.course1ListColumns(this.course1Data).find((e=>this.form.schedule_No===e.schedule_No)),s=parseInt(t.min_Audience)-t.register_Count,s-1>=0?this.$store.dispatch("saveCoursePeople",this.form).then((t=>{t.data.isOK&&(this.$message({type:"success",duration:"5000",showClose:!0,message:"送出成功"}),this.resetForm(e),this.getData())})):this.$message({type:"error",duration:"5000",showClose:!0,message:"人數已滿，無法報名"})}else this.$message({type:"error",duration:"5000",showClose:!0,message:"資料填寫錯誤"})}))},resetForm(e){this.$refs[e].resetFields(),this.form.people=[]},course1ListColumns(e){return e.forEach(((e,t)=>{e.index=t+1,e.label=`${e.class_Date}(${e.whatday}), ${e.course_Name}-${e.schedule_No}, ${e.room_Description}(${e.begin_Time}), 剩${e.min_Audience-e.register_Count}${"Y"===e.special_Class?"(資格限定)":""}`})),e},course2ListColumns(e){return e.forEach(((e,t)=>{e.index=t+1,e.col2=`${e.class_Date}(${e.whatday})`,e.col4=`${e.begin_Time} ~ ${e.end_Time}`,e.col5=`${e.course_Name}(${e.schedule_No})`,e.col6=`${e.register_Count}/ ${e.min_Audience}`})),e},cancelSignUpListColumns(e){return e.forEach(((e,t)=>{e.index=t+1,e.col1=`${e.p_Name}/${e.sex}/${e.id}`,e.signUpStatus=e.available_Begin_Date,e.approveStatus=e.approve_Status,e.col3=`${e.tmpinsurancebegin} ~ ${e.tmpinsuranceend}`,e.col4=`${e.available_Begin_Date}/${e.c_s_Status_Description}`,e.col5=`${e.available_Begin_Date} / ${e.course_Name}`,e.fileName=e.file_Name})),e}},mounted(){this.getData(),this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0}},c=n,d=s(1001),u=(0,d.Z)(c,a,l,!1,null,"3cebff3b",null),p=u.exports}}]);
//# sourceMappingURL=6461.ff2f5da7df14a0c2.js.map