"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[3094],{4865:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pagination"},[e("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:t.totalLength,"current-page":t.currentPage},on:{"current-change":t.changePage}})],1)},o=[],r={name:"pagination1-component",props:["totalLength"],computed:{currentPage(){return this.$store.state.currentPage}},methods:{changePage(t){this.$emit("changePageHandler",t)}},mounted(){}},l=r,n=a(1001),i=(0,n.Z)(l,s,o,!1,null,"86225bf4",null),c=i.exports},1919:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-responsive"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.data,"row-key":t.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":t.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":t.selectChangeHandler}},[t._t("custom-selection"),t._t("custom-checkbox1"),t._t("custom-checkbox2"),t._l(t.tableColumns,(function(a,s){return e("el-table-column",{key:s,attrs:{prop:a.id,label:a.label,width:a.width,sortable:"date"===a.id},scopedSlots:t._u([{key:"default",fn:function(s){return["status"===a.id?e("el-tag",{attrs:{type:"簽核通過"===s.row.status||"審核通過"===s.row.status?"success":"拒絕申請"===s.row.status?"danger":"草稿"===s.row.status?"warning":"查無資料"}},[t._v(" "+t._s(s.row.status)+" ")]):"status_Id"===a.id?e("el-tag",{attrs:{type:"OPEN"===s.row.status_Id?"":"CLOSE"===s.row.status_Id?"danger":"FULL"===s.row.status_Id?"warning":"success"}},[t._v(" "+t._s(t.getCourseState(s.row.status_Id))+" ")]):"description2"===a.id?e("el-tag",{attrs:{type:"有效課程"===s.row.description?"":"danger"}},[t._v(" "+t._s(s.row.description)+" ")]):"approve_Status"===a.id?e("el-tag",{attrs:{type:"0"===s.row.approve_Status?"":"1"===s.row.approve_Status?"success":"danger"}},[t._v(" "+t._s(t.getApproveStatus(s.row.approve_Status))+" ")]):"approve_Status2"===a.id?e("el-tag",{attrs:{type:"審核中"===s.row.approve_Status2||"未審核"===s.row.approve_Status2?"":"審核完畢"===s.row.approve_Status2||"審核同意"===s.row.approve_Status2?"success":"danger"}},[t._v(" "+t._s(s.row.approve_Status2)+" ")]):"attend_Status"===a.id?e("el-tag",{attrs:{type:"0"===s.row.attend_Status?"":"1"===s.row.attend_Status?"success":"danger"}},[t._v(" "+t._s(t.getAttendStatus(s.row.attend_Status))+" ")]):"issue_Card"===a.id?e("el-tag",{attrs:{type:"0"===s.row.issue_Card?"":"1"===s.row.issue_Card?"success":"danger"}},[t._v(" "+t._s(t.getIssueCardStatus(s.row.issue_Card))+" ")]):"signUpStatus"===a.id?e("el-tag",{attrs:{type:"已結案"===t.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"success":"可取消報名"===t.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"danger":""}},[t._v(" "+t._s(t.signUpStatus(s.row.signUpStatus,s.row.approveStatus))+" ")]):"file_Name"===a.id||"d_File_Name"===a.id?e("a",{attrs:{href:"#"},on:{click:function(e){return t.downloadPdf(s.row)}}},[t._v(t._s(s.row[a.id]))]):"protocolInfo"===a.id?e("div",[e("div",[t._v(t._s(s.row.po_Name))]),t._l(s.row.files,(function(a){return e("div",[e("a",{attrs:{href:"#"},on:{click:function(e){return t.downloadPdf(a)}}},[t._v(t._s(a.file_Name))])])}))],2):"useable"===a.id&&"已刪除(廠商不可申請每日工單)"===s.row.useable?e("span",{staticStyle:{color:"red"}},[t._v(t._s(s.row.useable))]):"deleted"===a.id?e("span",{class:{"text-danger":"1"===s.row.deleted}},[t._v(" "+t._s(s.row.effect)+" ")]):"array_data"===a.id?e("span",t._l(s.row[a.id],(function(a,s){return e("p",{key:s,staticClass:"mb-0"},[t._v(t._s(a))])})),0):RegExp(/\n/).test(s.row[s.column.property])?e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(" "+t._s(s.row[a.id])+" ")]):e("span",[t._v(t._s(s.row[a.id]))])]}}],null,!0)})})),t._t("custom-edit-select"),t._t("custom-switch"),t._t("custom-function"),t._t("slot-sheet-open")],2)],1)},o=[],r={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(t){this.$emit("selectionChange",t)},downloadPdf(t){const e=t.file_Id;this.$emit("downloadPdfHandler",e),this.$emit("downloadPdfHandler2",t)},getRowKeys(t){return t.index?t.index:t.id},rowStyleHandler(t){if("1"===t.row.isWeekend||"1"===t.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},l=r,n=a(1001),i=(0,n.Z)(l,s,o,!1,null,"4a0f1604",null),c=i.exports},3094:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[e("h2",{staticClass:"form-title"},[t._v("權限管理")]),e("el-card",{staticClass:"mb-4",attrs:{shadow:"never"}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[e("div",{staticClass:"d-flex"},[e("el-form-item",{staticClass:"w-100",class:{"w-100":t.displayFabHandler()},attrs:{label:"管理身份",prop:"col1"}},[e("el-select",{model:{value:t.form.col1,callback:function(e){t.$set(t.form,"col1",e)},expression:"form.col1"}},t._l(t.groups,(function(t,a){return e("el-option",{key:a,attrs:{label:t.userGroup_Desc,value:t.userGroup}})})),1)],1),t.displayFabHandler()?e("el-form-item",{staticClass:"w-100 ms-3",attrs:{label:"廠區名稱",prop:"col2"}},[e("el-select",{attrs:{"value-key":"id"},on:{change:t.locationChangeHandler},model:{value:t.form.col2,callback:function(e){t.$set(t.form,"col2",e)},expression:"form.col2"}},t._l(t.location,(function(t){return e("el-option",{key:t.location_Id,attrs:{label:t.description+"("+t.location_Id+")",value:t}})})),1)],1):t._e()],1),e("div",{staticClass:"d-flex"},["FAB_USER"===t.form.col1?e("el-form-item",{class:{"w-100":"FAB_USER"===t.form.col1},attrs:{label:"FAB廠別",prop:"col3"}},[e("el-select",{model:{value:t.form.col3,callback:function(e){t.$set(t.form,"col3",e)},expression:"form.col3"}},t._l(t.fabOptions,(function(t){return e("el-option",{key:t.fab_Id,attrs:{label:t.fab_Name,value:t.fab_Id}})})),1)],1):t._e(),e("el-form-item",{staticClass:"w-100",class:{"w-100":t.displayFabHandler(),"ms-3":"FAB_USER"===t.form.col1},attrs:{label:"管理者工號",prop:"col4"}},[e("el-select",{attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"請輸入工號",loading:t.loading,"loading-text":"載入中","no-data-text":"查無資料"},on:{clear:t.allPeopleChange},nativeOn:{keyup:function(e){return t.allPeopleRemoteMethod(e)}},model:{value:t.form.col4,callback:function(e){t.$set(t.form,"col4",e)},expression:"form.col4"}},t._l(t.options,(function(t,a){return e("el-option",{key:t.emp_no,attrs:{label:t.name+"("+t.emp_no+")",value:t.emp_no}})})),1),e("p",{staticClass:"note mb-0 mt-1"},[t._v(t._s(t.$store.state.remoteSearchNote))])],1)],1),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.addForm("form")}}},[t._v("新增管理人員")])],1)],1),e("h2",{staticClass:"form-title mb-2"},[t._v("現有權限使用者清單")]),e("div",{staticClass:"d-flex align-items-center mb-2"},[e("p",{staticStyle:{color:"#D50D1E","font-weight":"350"}},[t._v("離職員工自行刪除權限")]),e("el-input",{staticClass:"search-text w-50 ms-auto",attrs:{placeholder:"Search","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(e){return t.searchInput(e)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e("TableComponent",{attrs:{data:t.tableData,tableColumns:t.tableColumns},scopedSlots:t._u([{key:"custom-function",fn:function(){return[e("el-table-column",{attrs:{prop:"function",label:"操作",fixed:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刪除",placement:"top-start"}},[e("el-popconfirm",{attrs:{title:"確定要刪除嗎？"},on:{confirm:function(e){return t.confirmHandler(a.row.rid)}}},[e("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e("i",{staticClass:"el-icon-delete"})])],1)],1)]}}])})]},proxy:!0}])})],1)},o=[],r=a(1919),l=a(4865);const n=t=>t.toString().toLowerCase(),i=(t,e)=>e?t.filter((t=>n(t.usergroup_Desc).includes(n(e))||n(t.col3).includes(n(e))||n(t.col5).includes(n(e)))):t;var c={name:"authManagementComponent",components:{TableComponent:r.Z,PaginationComponent:l.Z},data(){return{loading:!1,options:[],search:"",form:{col1:"",col2:"",col3:"",col4:""},rules:{col1:[{required:!0,message:"必填",trigger:"change"}],col2:[{required:!0,message:"必填",trigger:"change"}],col3:[{required:!0,message:"必填",trigger:"change"}],col4:[{required:!0,message:"必填",trigger:"change"}]},tableColumns:[{id:"index",label:"項次",width:"70"},{id:"usergroup_Desc",label:"角色描述",width:"200"},{id:"col3",label:"廠區名稱",width:"200"},{id:"fab_Description",label:"FAB場別",width:"200"},{id:"col5",label:"管理者工號",width:"200"},{id:"emp_Email",label:"email",width:"200"},{id:"col7",label:"部門/分機",width:"200"}],location_Id:"",fabOptions:[],data:[],tableData:[],tableList:[],fab:[],groups:[],location:[]}},computed:{},methods:{async searchInput(t){const e=t.target.value;e?"Enter"!==t.code&&"NumpadEnter"!==t.code||(this.tableData=i(this.data,e)):"Enter"!==t.code&&"NumpadEnter"!==t.code||(this.tableData=this.data)},async qryPersonPermission(){const t=await this.$store.dispatch("qryPersonPermission"),e=t.data.data;this.data=JSON.parse(JSON.stringify(e.allPeople)),this.data.forEach(((t,e)=>{t.index=e+1,t.col3=`${t.ld2||""}${t.ld3?`(${t.ld3})`:""}`,t.col5=`${t.emp_Name}(${t.user_No})`,t.col7=`${t.emp_Dept_Full_Name}/${t.emp_Extension_No}`})),this.tableData=JSON.parse(JSON.stringify(this.data)),this.tableList=this.tableData.slice(0,10),this.fab=e.fab,this.groups=e.groups,this.location=e.location},locationChangeHandler(t){this.location_Id=t.location_Id,this.fabOptions=this.fab.filter((e=>e.id===t.id)),this.form.col3=""},displayFabHandler(){return"FAB_USER"===this.form.col1||"FAC_USER"===this.form.col1||"SHE_USER"===this.form.col1||"GA_USER"===this.form.col1},async allPeopleRemoteMethod(t){if(this.loading=!0,"Enter"===t.code||"NumpadEnter"===t.code){if(this.loading=!1,!t.target.value)return;const e=await this.$store.dispatch("qryEmp",t.target.value);e.data.isOK&&(this.options=e.data.data)}},allPeopleChange(){this.options=[]},getUserGroupDesc(t){const e=this.groups.find((e=>e.userGroup===t)).userGroup_Desc;return e},changePage(t){this.$store.state.currentPage=t;const e=10*(t-1),a=10*t;this.tableList=this.tableData.slice(e,a)},async confirmHandler(t){const e=await this.$store.dispatch("delPersonPermission",encodeURIComponent(t));e.data.isOK&&(this.$message({type:"success",duration:"5000",showClose:!0,message:"刪除成功"}),this.qryPersonPermission())},addForm(t){this.$refs[t].validate((async t=>{if(t){const t={UserGroup:this.form.col1,UserGroup_Desc:this.getUserGroupDesc(this.form.col1),Emp_No:this.form.col4,Location_Id:this.location_Id,Fab_Id:this.form.col3},e=await this.$store.dispatch("insPersonPermission",t);e.data.isOK&&(this.$message({type:"success",duration:"5000",showClose:!0,message:"送出成功"}),this.qryPersonPermission())}else this.$message({type:"error",duration:"5000",showClose:!0,message:"資料填寫錯誤"})}))}},mounted(){this.$store.state.currentPage=1,this.qryPersonPermission(),this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0}},d=c,u=a(1001),p=(0,u.Z)(d,s,o,!1,null,null,null),m=p.exports}}]);
//# sourceMappingURL=3094.1936a4b1ee977add.js.map