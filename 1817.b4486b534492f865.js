"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[1817],{4865:function(e,t,a){a.d(t,{Z:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.totalLength,"current-page":e.currentPage},on:{"current-change":e.changePage}})],1)},r=[],i={name:"pagination1-component",props:["totalLength"],computed:{currentPage(){return this.$store.state.currentPage}},methods:{changePage(e){this.$emit("changePageHandler",e)}},mounted(){}},o=i,l=a(1001),n=(0,l.Z)(o,s,r,!1,null,"86225bf4",null),d=n.exports},1919:function(e,t,a){a.d(t,{Z:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-responsive"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.data,"row-key":e.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":e.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":e.selectChangeHandler}},[e._t("custom-selection"),e._t("custom-checkbox1"),e._t("custom-checkbox2"),e._l(e.tableColumns,(function(a,s){return t("el-table-column",{key:s,attrs:{prop:a.id,label:a.label,width:a.width,sortable:"date"===a.id},scopedSlots:e._u([{key:"default",fn:function(s){return["status"===a.id?t("el-tag",{attrs:{type:"簽核通過"===s.row.status||"審核通過"===s.row.status?"success":"拒絕申請"===s.row.status?"danger":"草稿"===s.row.status?"warning":"查無資料"}},[e._v(" "+e._s(s.row.status)+" ")]):"status_Id"===a.id?t("el-tag",{attrs:{type:"OPEN"===s.row.status_Id?"":"CLOSE"===s.row.status_Id?"danger":"FULL"===s.row.status_Id?"warning":"success"}},[e._v(" "+e._s(e.getCourseState(s.row.status_Id))+" ")]):"description2"===a.id?t("el-tag",{attrs:{type:"有效課程"===s.row.description?"":"danger"}},[e._v(" "+e._s(s.row.description)+" ")]):"approve_Status"===a.id?t("el-tag",{attrs:{type:"0"===s.row.approve_Status?"":"1"===s.row.approve_Status?"success":"danger"}},[e._v(" "+e._s(e.getApproveStatus(s.row.approve_Status))+" ")]):"approve_Status2"===a.id?t("el-tag",{attrs:{type:"審核中"===s.row.approve_Status2||"未審核"===s.row.approve_Status2?"":"審核完畢"===s.row.approve_Status2||"審核同意"===s.row.approve_Status2?"success":"danger"}},[e._v(" "+e._s(s.row.approve_Status2)+" ")]):"attend_Status"===a.id?t("el-tag",{attrs:{type:"0"===s.row.attend_Status?"":"1"===s.row.attend_Status?"success":"danger"}},[e._v(" "+e._s(e.getAttendStatus(s.row.attend_Status))+" ")]):"issue_Card"===a.id?t("el-tag",{attrs:{type:"0"===s.row.issue_Card?"":"1"===s.row.issue_Card?"success":"danger"}},[e._v(" "+e._s(e.getIssueCardStatus(s.row.issue_Card))+" ")]):"signUpStatus"===a.id?t("el-tag",{attrs:{type:"已結案"===e.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"success":"可取消報名"===e.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"danger":""}},[e._v(" "+e._s(e.signUpStatus(s.row.signUpStatus,s.row.approveStatus))+" ")]):"file_Name"===a.id||"d_File_Name"===a.id?t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(s.row)}}},[e._v(e._s(s.row[a.id]))]):"protocolInfo"===a.id?t("div",[t("div",[e._v(e._s(s.row.po_Name))]),e._l(s.row.files,(function(a){return t("div",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(a)}}},[e._v(e._s(a.file_Name))])])}))],2):"useable"===a.id&&"已刪除(廠商不可申請每日工單)"===s.row.useable?t("span",{staticStyle:{color:"red"}},[e._v(e._s(s.row.useable))]):"deleted"===a.id?t("span",{class:{"text-danger":"1"===s.row.deleted}},[e._v(" "+e._s(s.row.effect)+" ")]):"array_data"===a.id?t("span",e._l(s.row[a.id],(function(a,s){return t("p",{key:s,staticClass:"mb-0"},[e._v(e._s(a))])})),0):RegExp(/\n/).test(s.row[s.column.property])?t("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(s.row[a.id])+" ")]):t("span",[e._v(e._s(s.row[a.id]))])]}}],null,!0)})})),e._t("custom-edit-select"),e._t("custom-switch"),e._t("custom-function"),e._t("slot-sheet-open")],2)],1)},r=[],i={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(e){this.$emit("selectionChange",e)},downloadPdf(e){const t=e.file_Id;this.$emit("downloadPdfHandler",t),this.$emit("downloadPdfHandler2",e)},getRowKeys(e){return e.index?e.index:e.id},rowStyleHandler(e){if("1"===e.row.isWeekend||"1"===e.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},o=i,l=a(1001),n=(0,l.Z)(o,s,r,!1,null,"4a0f1604",null),d=n.exports},7163:function(e,t,a){a.d(t,{Z:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload"},[t("el-upload",{ref:"Upload",staticClass:"upload-demo",attrs:{limit:e.limitNumber,action:e.uploadAction,"auto-upload":!1,"on-change":e.changeHandler,"on-remove":e.removeHandler}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上傳檔案")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTipText))])],1)],1)},r=[],i=a(942),o={name:"upload-component",data(){return{}},props:{uploadTipText:{type:[String],default:"檔案格式為PDF，在2MB以內"},uploadAction:{type:[String],default:i.apiUrl},limitNumber:{type:Number,default:1}},methods:{changeHandler(e,t){this.$emit("fileChangeHandler",t)},removeHandler(e,t){this.$emit("fileRemoveHandler",t)}},mounted(){}},l=o,n=a(1001),d=(0,n.Z)(l,s,r,!1,null,"442b61f1",null),p=d.exports},1817:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[t("h2",{staticClass:"form-title"},[e._v("展延申請")]),t("el-card",{staticClass:"mb-4",attrs:{shadow:"never"}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[t("el-row",[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"人員清單",prop:"add4Apply"}},[t("div",{staticClass:"directions",staticStyle:{"font-size":"14px"}},[e._v("人員清單只會秀出保險日期未維護或一個月內到期之人員")]),t("el-select",{attrs:{multiple:"",placeholder:"請選擇"},on:{change:e.add4ApplyHandler},model:{value:e.form.add4Apply,callback:function(t){e.$set(e.form,"add4Apply",t)},expression:"form.add4Apply"}},e._l(e.insChoiceList,(function(e,a){return t("el-option",{key:e.id,attrs:{label:e.p_Name+"("+e.id+")",value:e.id}})})),1)],1)],1)],1),t("el-form-item",{staticClass:"mb-0",attrs:{label:"展延人員"}},[t("div",{staticClass:"directions",staticStyle:{"font-size":"14px"}},[e._v("保險展延時間為必填")]),t("div",{staticClass:"w-75 table-responsive mb-0"},[t("table",{staticClass:"table"},[t("thead",[t("tr",[t("th",[e._v("項次")]),t("th",[e._v("身分證字號(姓名) ")]),t("th",[e._v("保險展延時間(開始)")]),t("th",[e._v("保險展延時間(結束)")]),t("th",[e._v("報名資料上傳")])])]),t("tbody",e._l(e.form.insPeople,(function(a,s){return t("tr",{key:a.id},[t("td",[e._v(e._s(s+1))]),t("td",[e._v(e._s(a.id)+"("+e._s(a.p_Name)+")")]),t("td",[t("el-form-item",{staticClass:"mb-0",attrs:{prop:"insPeople."+s+".insurance_Begin",rules:[{required:!0,message:"必填",trigger:"blur"}]}},[t("el-date-picker",{staticClass:"w-100",attrs:{type:"date","value-format":"yyyy/MM/dd",placeholder:"請選擇日期",clearable:""},model:{value:a.insurance_Begin,callback:function(t){e.$set(a,"insurance_Begin",t)},expression:"item.insurance_Begin"}})],1)],1),t("td",[t("el-form-item",{staticClass:"mb-0",attrs:{prop:"insPeople."+s+".insurance_End",rules:[{required:!0,message:"必填",trigger:"blur"}]}},[t("el-date-picker",{staticClass:"w-100",attrs:{type:"date","value-format":"yyyy/MM/dd",placeholder:"請選擇日期",clearable:""},model:{value:a.insurance_End,callback:function(t){e.$set(a,"insurance_End",t)},expression:"item.insurance_End"}})],1)],1),t("td",[t("el-form-item",{staticClass:"my-1",attrs:{prop:"insPeople."+s+".fileName",rules:[{required:!0,message:"必填",trigger:"change"}]}},[t("Upload",{attrs:{uploadTipText:"檔案格式為PDF，在1.5MB以內"},on:{fileChangeHandler:t=>e.insFileChgHandler(t,s),fileRemoveHandler:t=>e.insFileRmvHandler(t,s)},model:{value:a.fileName,callback:function(t){e.$set(a,"fileName",t)},expression:"item.fileName"}})],1)],1)])})),0)])])]),t("div",{staticClass:"mt-4"},[t("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.resetForm("form")}}},[e._v("重設")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("送出")])],1)],1)],1),t("h2",{staticClass:"form-title"},[e._v("保險展延申請狀態(七天內)人員清單")]),t("TableComponent",{attrs:{data:e.insApplierList,tableColumns:e.insApplierTableColumns},on:{downloadPdfHandler2:e.downloadPdf}}),t("Pagination1",{attrs:{totalLength:e.insApplier.length},on:{changePageHandler:e.changePage}})],1)},r=[],i=(a(7658),a(1919)),o=a(4865),l=a(7163),n=a(942),d={name:"extensionApply-component",components:{Upload:l.Z,TableComponent:i.Z,Pagination1:o.Z},data(){return{form:{add4Apply:[],insPeople:[]},rules:{add4Apply:[{required:!0,message:"必填",trigger:"change"}]},insApplierTableColumns:[{id:"index",label:"項次",width:"75"},{id:"create_date",label:"申請日期",width:"125"},{id:"personInfo",label:"姓名(性別)身分證字號",width:"180"},{id:"file_Name",label:"附檔",width:""},{id:"period",label:"保險展延期間(起~迄)",width:""},{id:"approve_Status2",label:"審核狀態",width:"125"},{id:"reject_Reason",label:"備註",width:"200"},{id:"name",label:"審核人員",width:"125"}]}},computed:{insChoiceList(){return this.$store.state.ins_choicelist},insApplier(){return this.$store.state.ins_applier},insApplierList(){return this.$store.state.ins_applierlist}},methods:{add4ApplyHandler(){this.form.insPeople=[];for(let e=0;e<this.form.add4Apply.length;e++){let t=this.insChoiceList.filter((t=>t.id==this.form.add4Apply[e]))[0];this.form.insPeople.push(t)}},async insFileChgHandler(e,t){let a=e[0].raw,s=await this.toBase64(a);this.form.insPeople[t].fileName=e[0].name,this.form.insPeople[t].fileBase64=s,this.$refs.form.clearValidate("insPeople."+t+".fileName")},insFileRmvHandler(e,t){this.form.insPeople[t].fileName="",this.form.insPeople[t].fileBase64="",this.$refs.form.validateField("insPeople."+t+".fileName")},toBase64(e){return new Promise(((t,a)=>{let s=new FileReader;s.readAsDataURL(e),s.onload=()=>t(s.result),s.onerror=e=>a(e)}))},resetForm(e){this.$refs[e].resetFields(),this.form.insPeople=[]},submitForm(e){this.$refs[e].validate((async t=>{if(t)try{const t=await this.$store.dispatch("addInsApplier",this.form.insPeople);t.data.isOK&&(this.$message({type:"success",duration:5e3,showClose:!0,message:"申請成功"}),this.resetForm(e),await this.$store.dispatch("getInsApplier"),this.$store.commit("CURRENT_PAGE_INIT"))}catch(a){console.log(a)}else this.$message({type:"error",showClose:!0,message:"資料填寫錯誤"})}))},async downloadPdf(e){try{const t=await this.$store.dispatch("commonDownloadPdf",{file_id:e.file_Id,router_Name:n.getInsuranceArea}),a=URL.createObjectURL(t.data),s=document.createElement("a");s.href=a,s.setAttribute("download",`${e.file_Name}`),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}catch(t){console.log(t)}},changePage(e){this.$store.commit("CHANGE_PAGE_HANDLER",{page:e,paramsDataName:"ins_applier",paramsListName:"ins_applierlist"})}},async mounted(){this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0;try{await this.$store.dispatch("getInsForChoice"),await this.$store.dispatch("getInsApplier")}catch(e){console.log(e)}this.$store.commit("CURRENT_PAGE_INIT")}},p=d,c=a(1001),u=(0,c.Z)(p,s,r,!1,null,null,null),m=u.exports}}]);
//# sourceMappingURL=1817.b4486b534492f865.js.map