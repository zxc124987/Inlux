"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[4490],{1919:function(t,e,a){a.d(e,{Z:function(){return c}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-responsive"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.data,"row-key":t.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":t.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":t.selectChangeHandler}},[t._t("custom-selection"),t._t("custom-checkbox1"),t._t("custom-checkbox2"),t._l(t.tableColumns,(function(a,s){return e("el-table-column",{key:s,attrs:{prop:a.id,label:a.label,width:a.width,sortable:"date"===a.id},scopedSlots:t._u([{key:"default",fn:function(s){return["status"===a.id?e("el-tag",{attrs:{type:"簽核通過"===s.row.status||"審核通過"===s.row.status?"success":"拒絕申請"===s.row.status?"danger":"草稿"===s.row.status?"warning":"查無資料"}},[t._v(" "+t._s(s.row.status)+" ")]):"status_Id"===a.id?e("el-tag",{attrs:{type:"OPEN"===s.row.status_Id?"":"CLOSE"===s.row.status_Id?"danger":"FULL"===s.row.status_Id?"warning":"success"}},[t._v(" "+t._s(t.getCourseState(s.row.status_Id))+" ")]):"description2"===a.id?e("el-tag",{attrs:{type:"有效課程"===s.row.description?"":"danger"}},[t._v(" "+t._s(s.row.description)+" ")]):"approve_Status"===a.id?e("el-tag",{attrs:{type:"0"===s.row.approve_Status?"":"1"===s.row.approve_Status?"success":"danger"}},[t._v(" "+t._s(t.getApproveStatus(s.row.approve_Status))+" ")]):"approve_Status2"===a.id?e("el-tag",{attrs:{type:"審核中"===s.row.approve_Status2||"未審核"===s.row.approve_Status2?"":"審核完畢"===s.row.approve_Status2||"審核同意"===s.row.approve_Status2?"success":"danger"}},[t._v(" "+t._s(s.row.approve_Status2)+" ")]):"attend_Status"===a.id?e("el-tag",{attrs:{type:"0"===s.row.attend_Status?"":"1"===s.row.attend_Status?"success":"danger"}},[t._v(" "+t._s(t.getAttendStatus(s.row.attend_Status))+" ")]):"issue_Card"===a.id?e("el-tag",{attrs:{type:"0"===s.row.issue_Card?"":"1"===s.row.issue_Card?"success":"danger"}},[t._v(" "+t._s(t.getIssueCardStatus(s.row.issue_Card))+" ")]):"signUpStatus"===a.id?e("el-tag",{attrs:{type:"已結案"===t.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"success":"可取消報名"===t.signUpStatus(s.row.signUpStatus,s.row.approveStatus)?"danger":""}},[t._v(" "+t._s(t.signUpStatus(s.row.signUpStatus,s.row.approveStatus))+" ")]):"file_Name"===a.id||"d_File_Name"===a.id?e("a",{attrs:{href:"#"},on:{click:function(e){return t.downloadPdf(s.row)}}},[t._v(t._s(s.row[a.id]))]):"protocolInfo"===a.id?e("div",[e("div",[t._v(t._s(s.row.po_Name))]),t._l(s.row.files,(function(a){return e("div",[e("a",{attrs:{href:"#"},on:{click:function(e){return t.downloadPdf(a)}}},[t._v(t._s(a.file_Name))])])}))],2):"useable"===a.id&&"已刪除(廠商不可申請每日工單)"===s.row.useable?e("span",{staticStyle:{color:"red"}},[t._v(t._s(s.row.useable))]):"deleted"===a.id?e("span",{class:{"text-danger":"1"===s.row.deleted}},[t._v(" "+t._s(s.row.effect)+" ")]):"array_data"===a.id?e("span",t._l(s.row[a.id],(function(a,s){return e("p",{key:s,staticClass:"mb-0"},[t._v(t._s(a))])})),0):RegExp(/\n/).test(s.row[s.column.property])?e("span",{staticStyle:{"white-space":"pre-wrap"}},[t._v(" "+t._s(s.row[a.id])+" ")]):e("span",[t._v(t._s(s.row[a.id]))])]}}],null,!0)})})),t._t("custom-edit-select"),t._t("custom-switch"),t._t("custom-function"),t._t("slot-sheet-open")],2)],1)},r=[],l={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(t){this.$emit("selectionChange",t)},downloadPdf(t){const e=t.file_Id;this.$emit("downloadPdfHandler",e),this.$emit("downloadPdfHandler2",t)},getRowKeys(t){return t.index?t.index:t.id},rowStyleHandler(t){if("1"===t.row.isWeekend||"1"===t.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},o=l,i=a(1001),n=(0,i.Z)(o,s,r,!1,null,"4a0f1604",null),c=n.exports},4490:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[e("div",{staticClass:"container mw-100 px-0 mb-3"},[e("el-button",{staticClass:"goBack",attrs:{type:"text"},on:{click:function(e){return t.goBack()}}},[e("i",{staticClass:"el-icon-back me-1"}),t._v("回上頁 ")]),t._m(0),e("el-form",{staticClass:"d-flex align-items-end justify-content-between"},[e("el-form-item",{staticClass:"mb-0 w-50",attrs:{label:"篩選類別"}},[e("el-select",{staticClass:"me-3",attrs:{placeholder:"請選擇"},on:{change:t.categoryHandler},model:{value:t.category,callback:function(e){t.category=e},expression:"category"}},[e("el-option",{attrs:{label:"全部",value:"0"}}),e("el-option",{attrs:{label:"台灣廠區承攬商入廠危害告知課程/南科場次",value:"36"}}),e("el-option",{attrs:{label:"台灣廠區承攬商入廠危害告知課程/竹科場次",value:"37"}})],1)],1),e("el-button",{attrs:{size:"small",type:"primary"}},[t.s_Id?e("router-link",{attrs:{to:{name:"createStaff",params:{s_id:t.s_Id}}}},[t._v(" 新增員工 ")]):t._e()],1)],1),t.selectedLists.length?e("div",{staticClass:"d-flex align-items-center mt-3 selected-box"},[e("span",[t._v("已選 "+t._s(t.selectedLists.length)+" 項")]),e("el-popconfirm",{attrs:{title:"確定要刪除嗎？"},on:{confirm:function(e){return t.confirmHandler()}}},[e("el-button",{staticClass:"ms-2",attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[t._v("刪除")])],1)],1):t._e()],1),e("div",{staticClass:"col-4",staticStyle:{float:"right"}},[e("el-input",{staticClass:"search-text",attrs:{placeholder:"可用「姓名/身份證號碼」模糊搜尋","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(e){return t.searchInput(e)}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e("el-table",{ref:"multipleTable",staticClass:"mb-3",staticStyle:{width:"100%"},attrs:{data:t.tableList,"row-key":t.getRowKeys},on:{"selection-change":t.changeSelection}},[e("el-table-column",{attrs:{type:"selection",width:"80","reserve-selection":!0}}),e("el-table-column",{attrs:{prop:"index",label:"項次"}}),e("el-table-column",{attrs:{prop:"name_id",label:"姓名(身份證號碼)",width:"150"}}),e("el-table-column",{attrs:{prop:"sex",label:"性別"}}),e("el-table-column",{attrs:{prop:"contact",label:"市話/行動電話/地址",width:"200"}}),e("el-table-column",{attrs:{prop:"country",label:"國籍"}}),e("el-table-column",{attrs:{prop:"",label:"台灣廠區承攬商入廠危害告知課程/南科場次"}},[e("el-table-column",{attrs:{prop:"classDateS",label:"上課日期",width:"150"}}),e("el-table-column",{attrs:{prop:"makeCardS",label:"製卡",width:"120"}}),e("el-table-column",{attrs:{prop:"insuranceDateS",label:"保險起迄時間",width:"150"}})],1),e("el-table-column",{attrs:{prop:"",label:"台灣廠區承攬商入廠危害告知課程/竹科場次"}},[e("el-table-column",{attrs:{prop:"classDateN",label:"上課日期",width:"150"}}),e("el-table-column",{attrs:{prop:"makeCardN",label:"製卡",width:"120"}}),e("el-table-column",{attrs:{prop:"insuranceDateN",label:"保險起迄時間",width:"150"}})],1),e("el-table-column",{attrs:{fixed:"right",label:"修改",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"員工資料修改",placement:"top-start"}},[e("el-button",{attrs:{type:"text"}},[e("router-link",{attrs:{to:{name:"editStaffProfile",params:{s_id:t.row.s_id,id:t.row.ID}}}},[e("i",{staticClass:"el-icon-document"})])],1)],1)]}}])})],1),e("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:t.tableData.length,"current-page":t.currentPage},on:{"current-change":t.changePage}})],1)},r=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex align-items-center mb-3"},[e("div",{staticClass:"col"},[e("h2",{staticClass:"form-title mb-0"},[t._v("人員管理")])]),e("div",{staticClass:"col-4"})])}],l=(a(7658),a(1919));const o=t=>t?t.toString().toLowerCase():t||"",i=(t,e)=>e?t.filter((t=>o(t.name_id).includes(o(e)))):t;var n={name:"companyProfileManagement-component",components:{tableComponent:l.Z},data(){return{s_Id:"",search:"",category:"",selectedLists:[],data:[],tableData:[],tableList:[],currentPage:1}},computed:{},methods:{getNewData(t){const e=t.reduce(((t,e)=>{const a={...e,course_Id2:37===e.course_Id?37:null,course_Name2:37===e.course_Id?e.course_Name:null,issue_Card2:37===e.course_Id?e.issue_Card:null,she_Class_Date2:37===e.course_Id?e.she_Class_Date:null};a.course_Id=36===e.course_Id?36:null,a.course_Name=36===e.course_Id?e.course_Name:null,a.issue_Card=36===e.course_Id?e.issue_Card:null,a.she_Class_Date=36===e.course_Id?e.she_Class_Date:null;let s=t.findIndex((t=>t.id===e.id));return s>=0&&Object.keys(t[s]).forEach((e=>{a[e]&&(t[s][e]=a[e])})),s<0&&t.push(a),t}),[]);return e},getRowKeys(t){return t.index?t.index:t.id},goBack(){this.$router.go(-1)},categoryHandler(t){this.tableData="0"!==t?this.data.filter((e=>e.course_Id===parseInt(t))):this.data,this.tableList=this.tableData.slice(0,10),this.currentPage=1},changeSelection(t){this.selectedLists=t},changePage(t){this.currentPage=t;const e=10*(t-1),a=10*t;this.tableList=this.tableData.slice(e,a)},confirmHandler(){const t=this.selectedLists.find((t=>t.s_id)).s_id,e=this.selectedLists.map((t=>t.id)),a={s_Id:t,emp_Ids:e,course_Id:Number(this.category)};this.deleteCourse(a)},async deleteCourse(t){try{const e=await this.$store.dispatch("deleteCourse",t);e.data.isOK&&(this.$message({type:"success",duration:5e3,showClose:!0,message:"刪除成功"}),this.$refs.multipleTable.clearSelection(),this.getVdrEmpList(this.s_Id),this.currentPage=1)}catch(e){console.log(e)}},async getVdrEmpList(t){try{const e=await this.$store.dispatch("getVdrEmpList",t);let a=e.data.data;const s=this.getNewData(a);this.data=JSON.parse(JSON.stringify(s)),this.tableData=this.data,this.tableData.forEach(((t,e)=>{t.index=e+1,t.ID=t.id,t.name_id=`${t.p_Name?t.p_Name:"無"}(${t.ID})`,t.contact=`${t.tel1}/${t.tel2}/${t.address}`,t.classDateS=t.she_Class_Date,t.makeCardS=1===t.issue_Card?"已製卡":"",t.insuranceDateS=`${t.insurance_Begin} ~ ${t.insurance_End}`,t.classDateN=t.she_Class_Date2,t.makeCardN=1===t.issue_Card2?"已製卡":"",t.insuranceDateN=`${t.insurance_Begin} ~ ${t.insurance_End}`})),this.tableList=this.tableData.slice(0,10)}catch(e){console.log(e)}},async searchInput(t){if("Enter"===t.code||"NumpadEnter"===t.code){const e=t.target.value;this.tableData=i(this.data,e),this.tableList=this.tableData.slice(0,10),this.$store.state.currentPage=1}}},async mounted(){this.s_Id=this.$route.params.s_id,this.getVdrEmpList(this.s_Id),this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0}},c=n,d=a(1001),u=(0,d.Z)(c,s,r,!1,null,"511d7eb0",null),p=u.exports}}]);
//# sourceMappingURL=4490.470d0e68d8c9a66b.js.map