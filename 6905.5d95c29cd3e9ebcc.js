"use strict";(self["webpackChunkinnolux"]=self["webpackChunkinnolux"]||[]).push([[6905],{4865:function(e,t,a){a.d(t,{Z:function(){return p}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",total:e.totalLength,"current-page":e.currentPage},on:{"current-change":e.changePage}})],1)},r=[],l={name:"pagination1-component",props:["totalLength"],computed:{currentPage(){return this.$store.state.currentPage}},methods:{changePage(e){this.$emit("changePageHandler",e)}},mounted(){}},s=l,i=a(1001),n=(0,i.Z)(s,o,r,!1,null,"86225bf4",null),p=n.exports},1919:function(e,t,a){a.d(t,{Z:function(){return p}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-responsive"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.data,"row-key":e.getRowKeys,"default-sort":{prop:"id",order:"ascending"},"empty-text":"查無資料","cell-class-name":e.rowStyleHandler,border:"","highlight-current-row":""},on:{"selection-change":e.selectChangeHandler}},[e._t("custom-selection"),e._t("custom-checkbox1"),e._t("custom-checkbox2"),e._l(e.tableColumns,(function(a,o){return t("el-table-column",{key:o,attrs:{prop:a.id,label:a.label,width:a.width,sortable:"date"===a.id},scopedSlots:e._u([{key:"default",fn:function(o){return["status"===a.id?t("el-tag",{attrs:{type:"簽核通過"===o.row.status||"審核通過"===o.row.status?"success":"拒絕申請"===o.row.status?"danger":"草稿"===o.row.status?"warning":"查無資料"}},[e._v(" "+e._s(o.row.status)+" ")]):"status_Id"===a.id?t("el-tag",{attrs:{type:"OPEN"===o.row.status_Id?"":"CLOSE"===o.row.status_Id?"danger":"FULL"===o.row.status_Id?"warning":"success"}},[e._v(" "+e._s(e.getCourseState(o.row.status_Id))+" ")]):"description2"===a.id?t("el-tag",{attrs:{type:"有效課程"===o.row.description?"":"danger"}},[e._v(" "+e._s(o.row.description)+" ")]):"approve_Status"===a.id?t("el-tag",{attrs:{type:"0"===o.row.approve_Status?"":"1"===o.row.approve_Status?"success":"danger"}},[e._v(" "+e._s(e.getApproveStatus(o.row.approve_Status))+" ")]):"approve_Status2"===a.id?t("el-tag",{attrs:{type:"審核中"===o.row.approve_Status2||"未審核"===o.row.approve_Status2?"":"審核完畢"===o.row.approve_Status2||"審核同意"===o.row.approve_Status2?"success":"danger"}},[e._v(" "+e._s(o.row.approve_Status2)+" ")]):"attend_Status"===a.id?t("el-tag",{attrs:{type:"0"===o.row.attend_Status?"":"1"===o.row.attend_Status?"success":"danger"}},[e._v(" "+e._s(e.getAttendStatus(o.row.attend_Status))+" ")]):"issue_Card"===a.id?t("el-tag",{attrs:{type:"0"===o.row.issue_Card?"":"1"===o.row.issue_Card?"success":"danger"}},[e._v(" "+e._s(e.getIssueCardStatus(o.row.issue_Card))+" ")]):"signUpStatus"===a.id?t("el-tag",{attrs:{type:"已結案"===e.signUpStatus(o.row.signUpStatus,o.row.approveStatus)?"success":"可取消報名"===e.signUpStatus(o.row.signUpStatus,o.row.approveStatus)?"danger":""}},[e._v(" "+e._s(e.signUpStatus(o.row.signUpStatus,o.row.approveStatus))+" ")]):"file_Name"===a.id||"d_File_Name"===a.id?t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(o.row)}}},[e._v(e._s(o.row[a.id]))]):"protocolInfo"===a.id?t("div",[t("div",[e._v(e._s(o.row.po_Name))]),e._l(o.row.files,(function(a){return t("div",[t("a",{attrs:{href:"#"},on:{click:function(t){return e.downloadPdf(a)}}},[e._v(e._s(a.file_Name))])])}))],2):"useable"===a.id&&"已刪除(廠商不可申請每日工單)"===o.row.useable?t("span",{staticStyle:{color:"red"}},[e._v(e._s(o.row.useable))]):"deleted"===a.id?t("span",{class:{"text-danger":"1"===o.row.deleted}},[e._v(" "+e._s(o.row.effect)+" ")]):"array_data"===a.id?t("span",e._l(o.row[a.id],(function(a,o){return t("p",{key:o,staticClass:"mb-0"},[e._v(e._s(a))])})),0):RegExp(/\n/).test(o.row[o.column.property])?t("span",{staticStyle:{"white-space":"pre-wrap"}},[e._v(" "+e._s(o.row[a.id])+" ")]):t("span",[e._v(e._s(o.row[a.id]))])]}}],null,!0)})})),e._t("custom-edit-select"),e._t("custom-switch"),e._t("custom-function"),e._t("slot-sheet-open")],2)],1)},r=[],l={name:"table-component",props:["data","tableColumns"],data(){return{api:this.apiUrl,loading:!0}},methods:{selectChangeHandler(e){this.$emit("selectionChange",e)},downloadPdf(e){const t=e.file_Id;this.$emit("downloadPdfHandler",t),this.$emit("downloadPdfHandler2",e)},getRowKeys(e){return e.index?e.index:e.id},rowStyleHandler(e){if("1"===e.row.isWeekend||"1"===e.row.isNight)return"fontColorBlue"}},mounted(){this.data&&(this.loading=!1)}},s=l,i=a(1001),n=(0,i.Z)(s,o,r,!1,null,"4a0f1604",null),p=n.exports},7163:function(e,t,a){a.d(t,{Z:function(){return d}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upload"},[t("el-upload",{ref:"Upload",staticClass:"upload-demo",attrs:{limit:e.limitNumber,action:e.uploadAction,"auto-upload":!1,"on-change":e.changeHandler,"on-remove":e.removeHandler}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上傳檔案")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTipText))])],1)],1)},r=[],l=a(942),s={name:"upload-component",data(){return{}},props:{uploadTipText:{type:[String],default:"檔案格式為PDF，在2MB以內"},uploadAction:{type:[String],default:l.apiUrl},limitNumber:{type:Number,default:1}},methods:{changeHandler(e,t){this.$emit("fileChangeHandler",t)},removeHandler(e,t){this.$emit("fileRemoveHandler",t)}},mounted(){}},i=s,n=a(1001),p=(0,n.Z)(i,o,r,!1,null,"442b61f1",null),d=p.exports},6905:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:this.$root.overlay,expression:"this.$root.overlay",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"wrapper"},[t("h2",{staticClass:"form-title"},[e._v("入退會申請")]),t("el-card",{staticClass:"mb-4",attrs:{shadow:"never"}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"申請種類",prop:"apply_Cateroy"}},[t("el-radio",{attrs:{label:"1",value:"1"},on:{change:function(t){return e.chgCategoryHandler()}},model:{value:e.form.apply_Cateroy,callback:function(t){e.$set(e.form,"apply_Cateroy",t)},expression:"form.apply_Cateroy"}},[e._v("加入申請")]),t("el-radio",{attrs:{label:"3",value:"3"},on:{change:function(t){return e.chgCategoryHandler()}},model:{value:e.form.apply_Cateroy,callback:function(t){e.$set(e.form,"apply_Cateroy",t)},expression:"form.apply_Cateroy"}},[e._v("更新申請")]),t("el-radio",{attrs:{label:"2",value:"2"},on:{change:function(t){return e.chgCategoryHandler()}},model:{value:e.form.apply_Cateroy,callback:function(t){e.$set(e.form,"apply_Cateroy",t)},expression:"form.apply_Cateroy"}},[e._v("退出申請")])],1),t("el-row",[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"各廠入會狀況",prop:"org4Apply"}},[t("el-select",{attrs:{"value-key":"po_Name",placeholder:"請選擇"},model:{value:e.form.org4Apply,callback:function(t){e.$set(e.form,"org4Apply",t)},expression:"form.org4Apply"}},e._l(e.orgChoiceList,(function(e,a){return t("el-option",{key:e.po_Id,attrs:{label:e.po_Name,value:e}})})),1)],1)],1)],1),t("el-row",{staticClass:"mb-3"},[t("el-col",{attrs:{span:8}},[t("label",{attrs:{for:""}},[e._v("入會日期：")]),t("span",[e._v(e._s(e.form.org4Apply.in_Date))])]),t("el-col",{attrs:{span:8}},[t("label",{attrs:{for:""}},[e._v("退會日期：")]),t("span",[e._v(e._s(e.form.org4Apply.out_Date))])])],1),t("el-form-item",{attrs:{label:"資格",prop:"authorization"}},[t("el-checkbox",{attrs:{label:"F",value:"F"},on:{change:function(t){return e.chgAuthorizationHandler()}},model:{value:e.form.authorization,callback:function(t){e.$set(e.form,"authorization",t)},expression:"form.authorization"}},[e._v("主包")]),t("el-checkbox",{attrs:{label:"S",value:"S"},on:{change:function(t){return e.chgAuthorizationHandler()}},model:{value:e.form.authorization,callback:function(t){e.$set(e.form,"authorization",t)},expression:"form.authorization"}},[e._v("下包")])],1),t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{staticStyle:{"font-size":"16px"}},[e._v("附檔")]),t("div",{staticClass:"directions"},[e._v("檔案格式為PDF，在1MB以內")])]),t("el-col",{attrs:{span:10}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"2"!=e.form.apply_Cateroy,expression:"form.apply_Cateroy!='2'"}],attrs:{label:"入會繳交附檔資料",prop:"fileName1"}},[t("Upload",{ref:"fileRef1",attrs:{uploadTipText:""},on:{fileChangeHandler:t=>e.orgFileChgHandler(t,1),fileRemoveHandler:t=>e.orgFileRmvHandler(t,1)},model:{value:e.form.fileName1,callback:function(t){e.$set(e.form,"fileName1",t)},expression:"form.fileName1"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"2"!=e.form.apply_Cateroy&&-1!=e.form.authorization.indexOf("F"),expression:"form.apply_Cateroy!='2' && form.authorization.indexOf('F')!=-1"}]},[t("el-form-item",{attrs:{label:"工作守則",prop:"fileName2"}},[t("Upload",{ref:"fileRef2",attrs:{uploadTipText:""},on:{fileChangeHandler:t=>e.orgFileChgHandler(t,2),fileRemoveHandler:t=>e.orgFileRmvHandler(t,2)},model:{value:e.form.fileName2,callback:function(t){e.$set(e.form,"fileName2",t)},expression:"form.fileName2"}})],1),t("el-form-item",{attrs:{label:"職業安全衛生組織核備函",prop:"fileName3"}},[t("Upload",{ref:"fileRef3",attrs:{uploadTipText:"(1) 未滿30人，請繳交業務主管影本 (不須向主管機關核備)"},on:{fileChangeHandler:t=>e.orgFileChgHandler(t,3),fileRemoveHandler:t=>e.orgFileRmvHandler(t,3)},model:{value:e.form.fileName3,callback:function(t){e.$set(e.form,"fileName3",t)},expression:"form.fileName3"}})],1),t("el-form-item",{attrs:{label:"",prop:"fileName4"}},[t("Upload",{ref:"fileRef4",attrs:{uploadTipText:"(2) 人數≧30人以上時，須向主管機關辦理安衛人員組織核備後再繳交核備函"},on:{fileChangeHandler:t=>e.orgFileChgHandler(t,4),fileRemoveHandler:t=>e.orgFileRmvHandler(t,4)},model:{value:e.form.fileName4,callback:function(t){e.$set(e.form,"fileName4",t)},expression:"form.fileName4"}})],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"2"==e.form.apply_Cateroy,expression:"form.apply_Cateroy=='2'"}],attrs:{label:"退會繳交附檔資料",prop:"fileName5"}},[t("Upload",{ref:"fileRef5",attrs:{uploadTipText:""},on:{fileChangeHandler:t=>e.orgFileChgHandler(t,5),fileRemoveHandler:t=>e.orgFileRmvHandler(t,5)},model:{value:e.form.fileName5,callback:function(t){e.$set(e.form,"fileName5",t)},expression:"form.fileName5"}})],1)],1)],1)],1),t("div",{staticClass:"mt-4"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("送出")])],1)],1),t("h2",{staticClass:"form-title"},[e._v("協議組織申請清單")]),t("TableComponent",{attrs:{data:e.orgApplierList,tableColumns:e.orgApplierTableColumns},on:{downloadPdfHandler2:e.downloadPdf},scopedSlots:e._u([{key:"custom-function",fn:function(){return[t("el-table-column",{attrs:{prop:"function",label:"操作",fixed:"right",width:"130"},scopedSlots:e._u([{key:"default",fn:function(a){return["0"==a.row.status_Flag?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"刪除",placement:"top-start"}},[t("el-popconfirm",{attrs:{title:"確定要刪除嗎？"},on:{confirm:function(t){return e.confirmHandler(a.row.pact_Apply_Id)}}},[t("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t("i",{staticClass:"el-icon-delete"})])],1)],1):e._e()]}}])})]},proxy:!0}])}),t("Pagination1",{attrs:{totalLength:e.orgApplier.length},on:{changePageHandler:e.changePage}})],1)},r=[],l=a(1919),s=a(4865),i=a(7163),n=a(942),p={name:"joinQuitApply-component",components:{TableComponent:l.Z,Pagination1:s.Z,Upload:i.Z},data(){return{form:{apply_Cateroy:"1",org4Apply:"",authorization:[],fileName1:"",file1:"",fileName2:"",file2:"",fileName3:"",file3:"",fileName4:"",file4:"",fileName5:"",file5:""},rules:{apply_Cateroy:[{required:!0,message:"必填",trigger:"change"}],org4Apply:[{required:!0,message:"必填",trigger:"change"}],authorization:[{required:!0,message:"必填",trigger:"change"}]},orgApplierTableColumns:[{id:"index",label:"項次",width:"75"},{id:"apply_Cateroy",label:"申請種類",width:"150"},{id:"protocolInfo",label:"組織名稱/附檔",width:"150"},{id:"apply_Date",label:"申請日期",width:"150"},{id:"authorization",label:"資格分類",width:"150"},{id:"status",label:"審核狀態",width:"150"},{id:"remark",label:"審核說明",width:"150"},{id:"name",label:"審核人員",width:"150"}]}},computed:{orgChoiceList(){return"1"==this.form.apply_Cateroy?this.$store.state.org_choicelist.filter((e=>!e.total)):this.$store.state.org_choicelist.filter((e=>e.total))},orgApplier(){return this.$store.state.org_applier},orgApplierList(){return this.$store.state.org_applierlist}},methods:{chgCategoryHandler(){this.form.org4Apply="",this.chgAuthorizationHandler()},chgAuthorizationHandler(){for(let e=1;e<=5;e++)this.orgFileRmvHandler("",e)},async orgFileChgHandler(e,t){let a=e[0].raw,o=await this.toBase64(a);this.form["fileName"+t]=e[0].name,this.form["file"+t]=o,this.$refs.form.clearValidate("fileName"+t)},orgFileRmvHandler(e,t){this.form["fileName"+t]="",this.form["file"+t]="",this.$refs["fileRef"+t].$refs.Upload.clearFiles()},toBase64(e){return new Promise(((t,a)=>{let o=new FileReader;o.readAsDataURL(e),o.onload=()=>t(o.result),o.onerror=e=>a(e)}))},submitForm(e){"2"==this.form.apply_Cateroy||-1==this.form.authorization.indexOf("F")||this.form.fileName3||this.form.fileName4?this.$refs[e].validate((async e=>{if(e){this.form.po_Id=this.form.org4Apply.po_Id,this.form.po_Name=this.form.org4Apply.po_Name,this.form.f_Authorization=-1!=this.form.authorization.indexOf("F")?"Y":"",this.form.s_Authorization=-1!=this.form.authorization.indexOf("S")?"Y":"";try{const e=await this.$store.dispatch("addOrgApplier",this.form);e.data.isOK&&(this.$message({type:"success",duration:5e3,showClose:!0,message:"申請成功"}),this.$refs.form.resetFields(),this.chgAuthorizationHandler(),this.$store.commit("CURRENT_PAGE_INIT"))}catch(t){console.log(t)}}else this.$message({type:"error",showClose:!0,message:"資料填寫錯誤"})})):this.$message({type:"error",showClose:!0,message:"職業安全衛生組織核備函，請至少擇一上傳"})},async downloadPdf(e){try{const t=await this.$store.dispatch("commonDownloadPdf",{file_id:e.file_Id,router_Name:n.getProtocolArea}),a=URL.createObjectURL(t.data),o=document.createElement("a");o.href=a,o.setAttribute("download",`${e.file_Name}`),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}catch(t){console.log(t)}},async confirmHandler(e){try{const t=await this.$store.dispatch("delOrgApplier",e);t.data.isOK&&(this.$message({type:"success",duration:"5000",showClose:!0,message:"刪除成功"}),this.$store.commit("CURRENT_PAGE_INIT"))}catch(t){console.log(t)}},changePage(e){this.$store.commit("CHANGE_PAGE_HANDLER",{page:e,paramsDataName:"org_applier",paramsListName:"org_applierlist"})}},async mounted(){this.$store.commit("HEADER_HANDLER",!0),this.$store.commit("BREADCRUMB_HANDLER",!0),this.$root.$children[0].sidebarSwitch=!0;try{await this.$store.dispatch("getOrgForChoice"),await this.$store.dispatch("getOrgApplier")}catch(e){console.log(e)}this.$store.commit("CURRENT_PAGE_INIT")}},d=p,c=a(1001),u=(0,c.Z)(d,o,r,!1,null,null,null),m=u.exports}}]);
//# sourceMappingURL=6905.5d95c29cd3e9ebcc.js.map